{{ $numberVariants := len .Pages}}
{{/*  See if there are variants   */}}

{{/*  Create x-data for default options  */}}
<div class=" grid grid-flow-row grid-cols-2 grid-rows-3 md:grid-cols-5 md:grid-rows lg:grid-cols-7  
        py-8" 
    style="grid-template-rows: auto auto 1fr;"
    x-data="{ 
    {{ range $index, $variants := .Pages }}  
    {{$index}} : {
        url: '{{ .Path  }}',
        id: '{{$variants.Params.variant_sku }}',
        retail: '{{$variants.Params.retail}}',
        price: '{{$variants.Params.variant_price}}',
        quantity: '1',
        stock: '{{ $variants.Params.variant_inventory_qty }}',
        image: '{{ $variants.Params.image_src}}',
        {{ partial "resources_image_resize_xdata.html" (dict "context" . "ImagesResources" $.Resources ) }}
        options: {
        {{ if $variants.Params.option1_name}}{{ $variants.Params.option1_name}} : '{{ $variants.Params.option1_value}}',{{end}}
        {{ if $variants.Params.option2_name}}{{ $variants.Params.option2_name}} : '{{ $variants.Params.option2_value}}',{{end}}
        {{ if $variants.Params.option3_name}}{{ $variants.Params.option3_name}} : '{{ $variants.Params.option3_value}}'{{end}}
        }
    },
    {{ end }}
    {{ range first 1 .Pages }}  
    title: '{{.Title}}',
    url: '{{ .Path }}',
    id: '{{.Params.variant_sku }}',
    retail: '{{.Params.retail}}',
    price: '{{.Params.variant_price}}',
    {{ partial "resources_image_resize_xdata.html" (dict "context" . "ImagesResources" $.Resources ) }}
    description: '{{.Params.description}}',
    quantity: '1',
    stock: '{{ .Params.variant_inventory_qty }}',
    tab: 'content'
    {{ end }}
    }">

{{/*  first 1/3  */}}
    {{/*  Title  */}}
    <div class="col-span-2 col-start-1 row-start-1 pl-8 text-left"><h2 class="text-2xl  mb-2 " >{{ .Title }}</h2></div>

    <div class="col-span-2  md:row-start-2 md:col-start-1 lg:row-start-2 lg:row-span-2 pl-8">
    {{/*  PRICE  */}}
        <div class="flex items-baseline py-2 ">
            <div x-text="price +  '€' "  class="flex-inline text-xl pr-2 font-robmono "></div>
            <div x-text="retail + '€' "  class="flex-inline text-lg font-normal line-through " x-show="retail > 0"></div>
        </div>
    {{/*  OPTIONS   */}}
        {{ partial "products_options.html" (dict "context" . "numberVariants" $numberVariants "ImagesResources" $.Resources ) }}
    </div>
{{/*  end first 1/3 */}}


{{/*  second 1/3  */}}
    <div class="col-span-3 row-start-2 md:col-start-3 md:row-start-1 md:row-span-2 lg:row-span-2 lg:row-start-1 px-4">
        {{/*  Image block  */}}
            <div class="flex justify-center w-full items-center h-full ">
                <img
                    x-bind:alt="title"
                    data-sizes="auto"
                    x-bind:srcset="        
                    image295w + ' 295w,' +
                    image394w + ' 394w,' +
                    image590w + ' 590w,' +
                    image700w + ' 700w,' +
                    image800w + ' 800w,' +
                    image1000w + ' 1000w,' +
                    image1200w + ' 1200w,' +
                    image1500w + ' 1500w,' +
                    image1800w + ' 1800w,' +
                    image2400w + ' 2400w' 
                    "
                    x-bind:data-src="image700w"
                    class="" />
            <!-- noscript pattern -->
                <noscript>
                    <img x-bind:src="image700w" />
                </noscript>
            </div>
        {{/*  end Image block  */}}
    </div>
{{/*  end second 1/3 */}}



{{/*  third 1/3  */}}
    <div class="col-span-2 mt-8 lg:mt-0 lg:row-start-1 lg:row-span-2 px-4">

        {{ if .Params.details }}
            <div class="flex-inline">
                <button 
                class="bg-gray-100 px-3 py-4 border-0 font-robmono" 
                x-bind:class="{ 'bg-gray-200': tab === 'content' }" 
                @click=" tab = 'content' " 
                type="button">
                Περιγραφή
                </button>

                <button 
                class="bg-gray-100 px-3 py-4 border-0 font-robmono"
                x-bind:class="{ 'bg-gray-200': tab === 'details' }"
                @click=" tab = 'details' " 
                type="button">
                Χαρακτηριστικά
                </button>
            </div>

            <div class="content py-4"  x-show=" tab ==='content' ">
                <div class="leading-relaxed">{{ .Content }}</div>
            </div>

            <div class="igredients py-4" x-show="tab === 'details' ">

            </div>

        {{ else }}   

            <div class="content py-4"  x-show=" tab ==='content' ">
                <div class="leading-relaxed">{{ .Content }}</div>
            </div>

        {{ end }}
    </div>
{{/*  end third 1/3  */}}

</div>

    {{ partial "sharethis.html" . }}

    {{/*  RELATED PRODUCTS  */}}
    {{ $related := .Site.RegularPages.RelatedIndices . "collections" | first 3 }}
    Related     {{ $related }}
    {{ with $related }}
    <h3>See Also</h3>
    <ul>
        {{ range . }}
        <li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
        {{ end }}
    </ul>
    {{ end }}

